Last login: Fri Jun 28 23:17:39 on ttys001

The default interactive shell is now zsh.
To update your account to use zsh, please run `chsh -s /bin/zsh`.
For more details, please visit https://support.apple.com/kb/HT208050.
MacBook-Air:~ k-matsumoto-2123$ MacBook-Air:~ k-matsumoto-2123$ 
MacBook-Air:~ k-matsumoto-2123$ 
MacBook-Air:~ k-matsumoto-2123$ 
MacBook-Air:~ k-matsumoto-2123$ 
MacBook-Air:~ k-matsumoto-2123$ cd .ssh
MacBook-Air:.ssh k-matsumoto-2123$ 
MacBook-Air:.ssh k-matsumoto-2123$ 
MacBook-Air:.ssh k-matsumoto-2123$ 
MacBook-Air:.ssh k-matsumoto-2123$ 
MacBook-Air:.ssh k-matsumoto-2123$ 
MacBook-Air:.ssh k-matsumoto-2123$ ssh -i "RaiseTech-kadai-keyPair.pem" ec2-user@ec2-3-112-19-222.ap-northeast-1.compute.amazonaws.com
The authenticity of host 'ec2-3-112-19-222.ap-northeast-1.compute.amazonaws.com (3.112.19.222)' can't be established.
ED25519 key fingerprint is SHA256:DPifRZLXc5j7QY3XyqtUtGpqYcUjZzOewR6LrAHt90U.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:305: 3.112.19.222
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'ec2-3-112-19-222.ap-northeast-1.compute.amazonaws.com' (ED25519) to the list of known hosts.
Last login: Fri Jun 28 14:32:47 2024 from m106073167096.v4.enabler.ne.jp
   ,     #_
   ~\_  ####_        Amazon Linux 2
  ~~  \_#####\
  ~~     \###|       AL2 End of Life is 2025-06-30.
  ~~       \#/ ___
   ~~       V~' '->
    ~~~         /    A newer version of Amazon Linux is available!
      ~~._.   _/
         _/ _/       Amazon Linux 2023, GA and supported until 2028-03-15.
       _/m/'           https://aws.amazon.com/linux/amazon-linux-2023/

[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ gem install serverspec
Fetching net-ssh-7.2.3.gem
Fetching net-telnet-0.2.0.gem
Fetching specinfra-2.89.0.gem
Fetching sfl-2.3.gem
Fetching rspec-core-3.13.0.gem
Fetching serverspec-2.42.3.gem
Fetching rspec-support-3.13.1.gem
Fetching rspec-mocks-3.13.1.gem
Fetching rspec-expectations-3.13.1.gem
Fetching rspec-3.13.0.gem
Fetching multi_json-1.15.0.gem
Fetching rspec-its-1.3.0.gem
Fetching net-scp-4.0.0.gem
Successfully installed sfl-2.3
Successfully installed net-telnet-0.2.0
Successfully installed net-ssh-7.2.3
Successfully installed net-scp-4.0.0
Successfully installed specinfra-2.89.0
Successfully installed rspec-support-3.13.1
Successfully installed rspec-expectations-3.13.1
Successfully installed rspec-core-3.13.0
Successfully installed rspec-its-1.3.0
Successfully installed rspec-mocks-3.13.1
Successfully installed rspec-3.13.0
Successfully installed multi_json-1.15.0
Successfully installed serverspec-2.42.3
Parsing documentation for sfl-2.3
Installing ri documentation for sfl-2.3
Parsing documentation for net-telnet-0.2.0
Installing ri documentation for net-telnet-0.2.0
Parsing documentation for net-ssh-7.2.3
Installing ri documentation for net-ssh-7.2.3
Parsing documentation for net-scp-4.0.0
Installing ri documentation for net-scp-4.0.0
Parsing documentation for specinfra-2.89.0
Installing ri documentation for specinfra-2.89.0
Parsing documentation for rspec-support-3.13.1
Installing ri documentation for rspec-support-3.13.1
Parsing documentation for rspec-expectations-3.13.1
Installing ri documentation for rspec-expectations-3.13.1
Parsing documentation for rspec-core-3.13.0
Installing ri documentation for rspec-core-3.13.0
Parsing documentation for rspec-its-1.3.0
Installing ri documentation for rspec-its-1.3.0
Parsing documentation for rspec-mocks-3.13.1
Installing ri documentation for rspec-mocks-3.13.1
Parsing documentation for rspec-3.13.0
Installing ri documentation for rspec-3.13.0
Parsing documentation for multi_json-1.15.0
Installing ri documentation for multi_json-1.15.0
Parsing documentation for serverspec-2.42.3
Installing ri documentation for serverspec-2.42.3
Done installing documentation for sfl, net-telnet, net-ssh, net-scp, specinfra, rspec-support, rspec-expectations, rspec-core, rspec-its, rspec-mocks, rspec, multi_json, serverspec after 7 seconds
13 gems installed
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ mkdir /var/www/raisetech-live8-sample-app/serverspec
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ 
[ec2-user@ip-10-0-0-233 ~]$ cd /var/www/raisetech-live8-sample-app/serverspec
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ serverspec-init
Your Gemfile lists the gem jsbundling-rails (>= 0) more than once.
You should probably keep only one of them.
Remove any duplicate entries and specify the gem only once.
While it's not a problem now, it could cause errors if you change the version of one of them later.
Select OS type:

  1) UN*X
  2) Windows

Select number: 1

Select a backend type:

  1) SSH
  2) Exec (local)

Select number: 2

 + spec/
 + spec/localhost/
 + spec/localhost/sample_spec.rb
 + spec/spec_helper.rb
 + Rakefile
 + .rspec
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ cat serverspec/spec/localhost/sample_spec.rb
cat: serverspec/spec/localhost/sample_spec.rb: No such file or directory
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ cat spec/localhost/sample_spec.rb
require 'spec_helper'

describe package('httpd'), :if => os[:family] == 'redhat' do
  it { should be_installed }
end

describe package('apache2'), :if => os[:family] == 'ubuntu' do
  it { should be_installed }
end

describe service('httpd'), :if => os[:family] == 'redhat' do
  it { should be_enabled }
  it { should be_running }
end

describe service('apache2'), :if => os[:family] == 'ubuntu' do
  it { should be_enabled }
  it { should be_running }
end

describe service('org.apache.httpd'), :if => os[:family] == 'darwin' do
  it { should be_enabled }
  it { should be_running }
end

describe port(80) do
  it { should be_listening }
end
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ vi spec/localhost/sample_spec.rb
"spec/localhost/sample_spec.rb" 28L, 642B▽             require 'spec_helper'describe package('httpd'), :if => os[:family] == 'redhat' doit { should be_installed }
end

describe package('apache2'), :if => os[:family] == 'ubuntu' do
  it { should be_installed }
end

describe service('httpd'), :if => os[:family] == 'redhat' do
  it { should be_enabled }
  it { should be_running }
end

describe service('apache2'), :if => os[:family] == 'ubuntu' do
  it { should be_enabled }
  it { should be_running }
end

describe service('org.apache.httpd'), :if => os[:family] == 'darwin' do
  it { should be_enabled }
  it { should be_running }
end

describe port(80) do
  it { should be_listening }
end
~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           1,1Allf732/e5d0732/e5d0^[          ^[P1+r      ^[P1    ^[  ^[  ^[  ^[  ^[  ^[  ::%d~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           ~                                                                                                                                           0,0-1All--No lines in buffer--0,0-1Alli -- INSERT --0,1Allrequire 'spec_helper'listen_port = 80# 想定通りの AMI が使用されているか
# 必要なパッケージが必要なバージョンでインストールされている担保が取れるため
describe command('curl http://169.254.169.254/latest/meta-data/ami-id') do
  its(:stdout) { should match /ami-024b33ed6cdf20e4c/ }
end# nginx が実行中であるか
describe service('nginx') do  it { should be_running }end# unicorn が実行中であるか
describe command('ps aux | grep unicorn | grep -v grep') do
  its(:exit_status) { should eq 0 }
end# 80 番 port が空いているかdescribe port(listen_port) do
  it { should be_listening }end# http リクエストが帰ってくるか
describe command('curl http://127.0.0.1:#{listen_port}/_plugin/head/ -o /dev/null -w "%{http_code}\n" -s') do
  its(:stdout) { should match /^200$/ }end30,1^[  30,0-1All::wq"spec/localhost/sample_spec.rb" 30L, 870B written
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ cat spec/localhost/sample_spec.rb
require 'spec_helper'

listen_port = 80

# 想定通りの AMI が使用されているか
# 必要なパッケージが必要なバージョンでインストールされている担保が取れるため
describe command('curl http://169.254.169.254/latest/meta-data/ami-id') do
  its(:stdout) { should match /ami-024b33ed6cdf20e4c/ }
end

# nginx が実行中であるか
describe service('nginx') do
  it { should be_running }
end

# unicorn が実行中であるか
describe command('ps aux | grep unicorn | grep -v grep') do
  its(:exit_status) { should eq 0 }
end

# 80 番 port が空いているか
describe port(listen_port) do
  it { should be_listening }
end

# http リクエストが帰ってくるか
describe command('curl http://127.0.0.1:#{listen_port}/_plugin/head/ -o /dev/null -w "%{http_code}\n" -s') do
  its(:stdout) { should match /^200$/ }
end

[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ rake spec
/home/ec2-user/.rvm/rubies/ruby-3.1.2/bin/ruby -I/home/ec2-user/.rvm/gems/ruby-3.1.2/gems/rspec-support-3.13.1/lib:/home/ec2-user/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.13.0/lib /home/ec2-user/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.13.0/exe/rspec --pattern spec/localhost/\*_spec.rb

Command "curl http://169.254.169.254/latest/meta-data/ami-id"
  stdout
    is expected to match /ami-024b33ed6cdf20e4c/

Service "nginx"
  is expected to be running

Command "ps aux | grep unicorn | grep -v grep"
  exit_status
    is expected to eq 0

Port "80"
  is expected to be listening

Command "curl http://127.0.0.1:#{listen_port}/_plugin/head/ -o /dev/null -w "%{http_code}\n" -s"
  stdout
    is expected to match /^200$/

Finished in 0.16214 seconds (files took 0.43584 seconds to load)
5 examples, 0 failures

[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ [ec2-user@ip-10-0-0-233 serverspec]$ [ec2-user@ip-10-0-0-233 serverspec]$ [ec2-user@ip-10-0-0-233 serverspec]$ [ec2-user@ip-10-0-0-233 serverspec]$ [ec2-user@ip-10-0-0-233 serverspec]$ [ec2-user@ip-10-0-0-233 serverspec]$ [ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 
[ec2-user@ip-10-0-0-233 serverspec]$ 